package main

import "strconv"

type CIDEventCode int

var CIDEventCodeMap = map[CIDEventCode]struct {
	Priority byte // 1 = high priority aka alarm, 2 = medium e.g. tamper, 3 = low e.g. reset
	Name     string
}{
	// Medical:
	100: {1, "Medical "},
	101: {1, "Pendant Transmitter "},
	102: {1, "Fail to report in "},
	// FIRE ALARMS:
	110: {1, "FIRE "},
	111: {1, "SMOKE  w/VERIFICATION "},
	112: {1, "Combustion "},
	113: {1, "WATERFLOW "},
	114: {1, "Heat "},
	115: {1, "Pull Station "},
	116: {1, "Duct "},
	117: {1, "Flame "},
	118: {1, "Near Alarm "},
	// PANIC ALARMS:
	120: {1, "Panic Alarm "},
	121: {1, "DURESS "},
	122: {1, "SILENT "},
	123: {1, "AUDIBLE "},
	124: {1, "Duress-Access Granted "},
	125: {1, "Duress-Egress Granted "},
	// BURGLAR ALARMS:
	130: {1, "Burglary "},
	131: {1, "PERIMETER "},
	132: {1, "INTERIOR "},
	133: {1, "24 HR BURG (AUX) "},
	134: {1, "ENTRY/EXIT "},
	135: {1, "DAY/NIGHT "},
	136: {1, "Outdoor "},
	137: {2, "TAMPER "},
	138: {2, "Near Alarm "},
	139: {2, "Intrusion Verifier "},
	// GENERAL ALARMS:
	140: {1, "General Alarm "},
	141: {2, "Polling Loop Open "},
	142: {2, "POLLING LOOP SHORT (AL) "},
	143: {2, "EXPANSION MOD FAILURE "},
	144: {2, "Sensor Tamper "},
	145: {2, "Expansion Module Tamper "},
	146: {1, "SILENT BURG "},
	147: {2, "Sensor Supervision "},
	// 24 HOUR NON-BURGLARY:
	150: {1, "24 HOUR (AUXILIARY) "},
	151: {2, "Gas Detected "},
	152: {2, "Refrigeration "},
	153: {2, "Loss of Heat "},
	154: {2, "Water Leakage "},
	155: {2, "Foil Break "},
	156: {2, "Day Trouble "},
	157: {2, "Low Bottled Gas Level "},
	158: {2, "High Temp "},
	159: {2, "Low Temp "},
	161: {2, "Loss of Air Flow "},
	162: {2, "Carbon Monoxide Detected "},
	163: {2, "Tank Level "},
	168: {2, "High Humidity "},
	169: {2, "Low Humidity "},
	// FIRE SUPERVISORY:
	200: {2, "FIRE SUPERVISORY "},
	201: {2, "Low Water Pressure "},
	202: {2, "Low CO2 "},
	203: {2, "Gate Valve Sensor "},
	204: {2, "Low Water Level "},
	205: {2, "Pump Activated "},
	206: {2, "Pump Failure "},
	// SYSTEM TROUBLES:
	300: {3, "System Trouble "},
	301: {3, "AC LOSS "},
	302: {3, "LOW SYSTEM BATT "},
	303: {3, "RAM Checksum Bad "},
	304: {3, "ROM Checksum Bad "},
	305: {3, "SYSTEM RESET "},
	306: {3, "PANEL PROG CHANGE "},
	307: {3, "Self-Test Failure "},
	308: {3, "System Shutdown "},
	309: {3, "Battery Test Fail "},
	310: {3, "GROUND FAULT "},
	311: {3, "Battery Missing "},
	312: {3, "Power Supply Overcurent "},
	313: {3, "Engineer Reset "},
	314: {3, "Primary Power Supply Failure "},
	316: {3, "System Tamper "},
	// SOUNDER/RELAY TROUBLES:
	320: {3, "SOUNDER / RELAY "},
	321: {3, "BELL 1 "},
	322: {3, "BELL 2 "},
	323: {3, "Alarm Relay "},
	324: {3, "Trouble Relay "},
	325: {3, "Reversing Relay "},
	326: {3, "Notification Appliance Ckt. # 3 "},
	327: {3, "Notification Appliance Ckt. # 4 "},
	// SYSTEM PERIPHERAL TROUBLES:
	330: {3, "System Peripheral (E355)"},
	331: {3, "Polling Loop Open "},
	332: {3, "POLLING LOOP SHORT "},
	333: {3, "Exp. Module Failure "},
	334: {3, "Repeater Failure "},
	335: {3, "Local Printer Paper Out "},
	336: {3, "Local Printer Failure "},
	337: {3, "EXP. MOD. DC LOSS "},
	338: {3, "EXP. MOD. LOW BAT "},
	339: {3, "EXP. MOD. RESET"},
	341: {3, "EXP. MOD. TAMPER"},
	342: {3, "Exp. Module AC Loss "},
	343: {3, "Exp. Module Self Test Fail "},
	344: {3, "RF Rcvr Jam Detect # "},
	345: {3, "AES Encryption disabled/enabled "},
	// COMMUNICATION TROUBLES:
	350: {3, "Communication "},
	351: {3, "TELCO 1 FAULT "},
	352: {3, "TELCO 2 FAULT "},
	353: {3, "LR Radion Xmitter Fault (333) "},
	354: {3, "FAILURE TO COMMUNICATE "},
	355: {3, "Loss of Radio Super.(R330) "},
	356: {3, "Loss of Central Polling "},
	357: {3, "LRR XMTR. VSWR "},
	// PROTECTION LOOP:
	370: {3, "Protection Loop "},
	371: {3, "Protection Loop Open "},
	372: {3, "Protection Loop Short "},
	373: {3, "FIRE TROUBLE "},
	374: {3, "EXIT ERROR (BY USER) "},
	375: {3, "Panic Zone Trouble "},
	376: {3, "Hold-Up Zone Trouble "},
	377: {3, "Swinger Trouble "},
	378: {3, "Cross-zone Trouble "},
	// SENSOR:
	380: {3, "SENSOR TRBL - GLOBAL "},
	381: {3, "LOSS OF SUPERVISION "},
	382: {3, "LOSS OF SUPRVSN "},
	383: {3, "SENSOR TAMPER "},
	384: {3, "RF LOW BATTERY "},
	385: {3, "SMOKE HI SENS. "},
	386: {3, "SMOKE LO SENS."},
	387: {3, "INTRUSION HI SENS. "},
	388: {3, "INTRUSION LO SENS. "},
	389: {3, "DET. SELF TEST FAIL "},
	391: {3, "Sensor Watch Failure "},
	392: {3, "Drift Comp. Error "},
	393: {3, "Maintenance Alert "},
	// OPEN/CLOSE:
	400: {3, "Open/Close "},
	401: {3, "OPEN/CLOSE BY USER "},
	402: {3, "Group O/C "},
	403: {3, "AUTOMATIC OPEN/CLOSE "},
	404: {3, "Late to O/C "},
	405: {3, "Deferred O/C "},
	406: {3, "CANCEL (BY USER) "},
	407: {3, "REMOTE ARM/DISARM "},
	408: {3, "QUICK ARM "},
	409: {3, "KEYSWITCH OPEN/CLOSE "},
	435: {3, "Second Person Access "},
	436: {3, "Irregular Access "},
	441: {3, "Armed Stay "},
	442: {3, "Keyswitch Armed Stay "},
	450: {3, "Exception O/C "},
	451: {3, "Early O/C "},
	452: {3, "Late O/C "},
	453: {3, "Failed to Open "},
	454: {3, "Failed to Close "},
	455: {3, "Auto-Arm Failed "},
	456: {3, "Partial Arm "},
	457: {3, "Exit Error (User) "},
	458: {3, "User on Premises "},
	459: {3, "Recent Close "},
	461: {3, "Wrong Code Entry "},
	462: {3, "Legal Code Entry "},
	463: {3, "Re-arm after Alarm "},
	464: {3, "Auto Arm Time Extended "},
	465: {3, "Panic Alarm Reset "},
	466: {3, "Service On/Off Premises "},
	// REMOTE ACCESS:
	411: {3, "CALLBACK REQUESTED "},
	412: {3, "Success-Download/access "},
	413: {3, "Unsuccessful Access "},
	414: {3, "System Shutdown "},
	415: {3, "Dialer Shutdown "},
	416: {3, "Successful Upload "},
	// ACCESS CONTROL:
	421: {3, "Access Denied "},
	422: {3, "Access Report by User "},
	423: {3, "Forced Access "},
	424: {3, "Egress Denied "},
	425: {3, "Egress Granted "},
	426: {3, "Access Door Propped Open "},
	427: {3, "Access Point DSM Trouble "},
	428: {3, "Access Point RTE Trouble "},
	429: {3, "Access Program Mode Entry "},
	430: {3, "Access Program Mode Exit "},
	431: {3, "Access Threat Level Change "},
	432: {3, "Access Relay/Trigger Fail "},
	433: {3, "Access RTE Shunt "},
	434: {3, "Access DSM Shunt "},
	// SYSTEM DISABLES:
	501: {3, "Access Reader Disable "},
	// SOUNDER/RELAY DISABLES:
	520: {3, "Sounder/Relay Disable "},
	521: {3, "Bell 1 Disable "},
	522: {3, "Bell 2 Disable "},
	523: {3, "Alarm Relay Disable "},
	524: {3, "Trouble Relay Disable "},
	525: {3, "Reversing Relay Disable "},
	526: {3, "Notification Appliance Ckt # 3 "},
	527: {3, "Notification Appliance Ckt # 4 "},
	// SYSTEM PERIPHERAL DISABLES:
	531: {3, "Module Added "},
	532: {3, "Module Removed "},
	// COMMUNICATION DISABLES:
	551: {3, "Dialer Disabled "},
	552: {3, "Radio Xmitter Disabled "},
	553: {3, "Remote Upload/Download "},
	// BYPASSES:
	570: {3, "ZONE/SENSOR BYPASS "},
	571: {3, "Fire Bypass "},
	572: {3, "24 Hour Zone Bypass "},
	573: {3, "Burg. Bypass "},
	574: {3, "Group Bypass "},
	575: {3, "SWINGER BYPASS "},
	576: {3, "Access Zone Shunt "},
	577: {3, "Access Point Bypass "},
	578: {3, "Zone Bypass "},
	579: {3, "Zone Bypass "},
	// TEST / MISC:
	601: {3, "MANUAL TEST "},
	602: {3, "PERIODIC TEST "},
	603: {3, "Periodic RF Xmission "},
	604: {3, "FIRE TEST "},
	605: {3, "Status Report To Follow "},
	606: {3, "LISTEN-IN TO FOLLOW "},
	607: {3, "WALK-TEST MODE "},
	608: {3, "System Trouble Present "},
	609: {3, "VIDEO XMTR ACTIVE "},
	611: {3, "POINT TESTED OK "},
	612: {3, "POINT NOT TESTED "},
	613: {3, "Intrusion Zone Walk Tested "},
	614: {3, "Fire Zone Walk Tested "},
	615: {3, "Panic Zone Walk Tested "},
	616: {3, "Service Request "},
	// EVENT LOG:
	621: {3, "EVENT LOG RESET "},
	622: {3, "EVENT LOG 50% FULL "},
	623: {3, "EVENT LOG 90% FULL "},
	624: {3, "EVENT LOG OVERFLOW "},
	625: {3, "TIME/DATE RESET "},
	626: {3, "TIME/DATE INACCURATE "},
	627: {3, "PROGRAM MODE ENTRY "},
	628: {3, "PROGRAM MODE EXIT "},
	// SCHEDULING:
	630: {3, "Schedule Change "},
	631: {3, "Exception Sched. Change "},
	632: {3, "Access Schedule Change "},
	// PERSONNEL MONITORING:
	641: {3, "Senior Watch Trouble "},
	642: {3, "Latch-key Supervision "},
	// SPECIAL CODES:
	651: {3, "ADT Authorised dealer"},
	// Miscellaneous:
	654: {3, "System Inactivity "},
	900: {3, "Download Abort "},
	901: {3, "Download Start/End "},
	902: {3, "Download Interrupted "},
	910: {3, "Auto-Close with Bypass "},
	911: {3, "Bypass Closing "},
	912: {3, "Fire Alarm Silenced "},
	913: {3, "Supervisory Point test Start/End Event - User-# "},
	914: {3, "Hold-up test Start/End "},
	915: {3, "Burg. Test Print Start/End "},
	916: {3, "Supervisory Test Print Start/End Event "},
	917: {3, "Burg. Diagnostics Start/End "},
	918: {3, "Fire Diagnostics Start/End "},
	919: {3, "Untyped diagnostics "},
	920: {3, "Trouble Closing (closed with burg. during exit) "},
	921: {3, "Access Denied Code Unknown "},
	922: {3, "Supervisory Point Alarm "},
	923: {3, "Supervisory Point Bypass "},
	924: {3, "Supervisory Point Trouble "},
	925: {3, "Hold-up Point Bypass "},
	926: {3, "AC Failure for 4 hours "},
	927: {3, "Output Trouble "},
	928: {3, "User code for event "},
	929: {3, "Log-off "},
	954: {3, "CS Connection Failure "},
	961: {3, "Rcvr Database Connection Fail/Restore "},
	962: {3, "License Expiration Notify "},
	// Other:
	999: {3, "1 and 1/3 DAY NO READ LOG "},

	// SRC: http://www.nexgenerationcentral.com/Portals/7/AdemcoContactID.pdf
}

func (c CIDEventCode) String() string {
	if s, ok := CIDEventCodeMap[c]; ok {
		return strconv.Itoa(int(c)) + " " + s.Name
	}
	return strconv.Itoa(int(c))
}

func (c CIDEventCode) Priority() byte {
	if s, ok := CIDEventCodeMap[c]; ok {
		return s.Priority
	}
	return 1
}
